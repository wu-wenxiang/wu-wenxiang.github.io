---
layout:         post
title:          Tricks Summary
category:       course
description:    Summary about lots of tiny tricks :-)
---

## Platform

### Shield Picture
- Symptom
	- Case: 631089414211611
- Why
	- 盾牌标志表示该文件经过Manifest和源代码审查，发现需要提升到Administrators组运行（只有那些一定要右键-以管理员身份运行才能打开的程序 ）。
- How
	- 首先检查对应文件的Manifest
	
			<security>
				<requestedPrivileges>
					<requestedExecutionLevel level="asInvoker" uiAccess="false"/>
				</requestedPrivileges>
			</security>

		这里的level是asInvoker，说明不需要Admin权限。
	- 然后检查：
		
			[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers]
			"C:\\Program Files\\Internet Explorer\\iexplore.exe"="~ RUNASADMIN"
			"C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe"="~ RUNASADMIN"
	
		如果在这里有设置，对应的应用程序启动时，会带一个环境变量：__COMPAT_LAYER，而且这个变量值是RunAsAdmin。

## Exchange

### Reverse Proxy
- 三部曲
	- [Part 1](https://blogs.technet.microsoft.com/exchange/2013/07/19/part-1-reverse-proxy-for-exchange-server-2013-using-iis-arr/)
	- [Part 2](https://blogs.technet.microsoft.com/exchange/2013/08/02/part-2-reverse-proxy-for-exchange-server-2013-using-iis-arr/)
	- [Part 3](https://blogs.technet.microsoft.com/exchange/2013/08/05/part-3-reverse-proxy-for-exchange-server-2013-using-iis-arr/)
- 注意点：
	- 要注意非常隐秘的一步：Response Buffer threshold: 0。不然RPC的call一直过不去

## Sharepoint

### 2010以后只支持集成模式


## IIS

### 配置文件监控
- [IIS Auditing](https://blogs.msdn.microsoft.com/webtopics/2010/03/19/iis-7-5-how-to-enable-iis-configuration-auditing/)，监控记录：`%SystemRoot%\System32\Winevt\Logs\Microsoft-IIS-Configuration%4Operational.evtx`
- Case: 357639415111611, Check Eventlog:
	- User DomainA\UserB restart the server, Reason Code,0x4040005,which means Application:Unresponsive.
	- Then there was an error occurred while saving the metabase file. This can happen when the metabase XML file is in use by another program, or if the disk is full.  Check for corresponding events in the event log for more details.
		- ErrorCode: 0x80070070
		- 0x80070070 means “There is not enough space on the disk”. So please help to check if there is enough space on your server.
	- At the same time with error occurred, the application Host helper service entered the stopped state.
	- Then, system have restarted ad the Application Host Helper Service encountered an error while reading the data for SID mapping. Please ensure that the application pool name data is correct in the configuration file.  To resolve this issue, please recommit the changes or restart this service.  The data field contains the error number. In the details we get the error number : 0x8007000D, which means “The data is invalid”.
	- Conclusion: that the disk may be full or there is no enough space on the disk. If this is a network path, make sure that network connectivity is not broken.
